# Production override: no --reload, no source mounts
# Set FRONTEND_PORT in .env if 80 is taken (e.g. by another site on VPS)
services:
  backend:
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000
    volumes: []   # no source mount – run from image
    ports:
      - "8003:8000"

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    command: ["nginx", "-g", "daemon off;"]
    ports:
      - "${FRONTEND_PORT:-80}:80"
    volumes:
      - ./frontend/nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - backend
    # No volumes – serve built assets from image; API via /api/ → backend
